#A Philippe Cara
#D 190829
#T Logbook for my DXpedition branch of yfktest
#C I also have a fieldday branch which one day will be merged with this one
#C First things I had to do to get everything working is install curses etc on 
#  my Linux Peppermint 9... This is mainly what I put in this file. The rest is 
#  in git.

#C My ambition is to get at least the following things done. Many of them I have 
#  already done in the past.
# * DONE change operator with Alt+p. See readakey.pl and yfktest
# * DONE put a frequency on 60m for correct Cabrillo and ADIF output. See writelog.pl
# * DONE get QSO info broadcast over local network. See logqso.pl and yfktest
# * DONE: ESC key to stop sending CW (as alternative to Alt+x). See readakey.pl
# * In the orig-latest, I get Subroutine main::getchar redefined at subs/dxcc.pl 
#   line 2. Maybe have a look at this? This error has disappeared but I don't 
#   know why.
# * How about adding Alt-t to tune radio for 6 seconds (or less with ESC) (or until you press any key)?
#   winkeyerdeamon has the command built in. Just send c with the number of seconds...
# * When starting yfktest reads the log and gives the red-background "status 
#   bar", then draws the logging window. The "status bar" stays on the screen. 
#   Maybe clear screen before drawing logging window?
# * +/-DONE 190926: More or less works. When you press F1, it now "runs" 
#   and keeps running until you press F1 again. In this mode, "ESC" stops 
#   sending but after cqinterval it starts again until you press F1. Next time 
#   you press F1,  it will again run. To go back to normal mode, prees ALT+E. 
#   Don't know if an  indication is needed for this mode. I don't think so. You 
#   see it when you press  F1. Also When changing speed or typing backspace in 
#   Running mode, it seems that  the run stops after ending the current message. 
#   To resume Running mode, press F1  (to go to Logging mode) and then F1 again 
#   to run again. Don't see how to fix it  but let's call it a known bug ;-) 
#   Maybe make a CQ repeat feature with ALT+E ? My Peppermint emphasizes the  
#   mouse pointer when you ALT+c :-( 
#
sudo apt install libcurses-perl
cd /mivies/HAM/yfktest
# The fieldday branch...
git clone git@bitbucket.org:pcara/nbttest.git 
# The DXpedition branch...
git clone git@bitbucket.org:pcara/yfktest-dx-pedition.git
# I have the original (as of 190829) branch in yfktest-orig-latest
# Later I will branch the official code and submit my addons

git commit -m "Fixed first line of yfktest to include -I ./ option so that subs can load."
# This is OK in orig-latest and was not needed in older PERL versions

# git asked me to configure it a bit...
git config --global user.email "pcara@vub.ac.be"
git config --global user.name "Philippe Cara"
git add yfktest
git commit -m "Fixed first line of yfktest to include -I ./ option so that subs can load."
git push
# To get the Fieldday branch going...
sudo apt install toilet
#Some tests...
while true; do echo "$(date '+%D %T' | toilet -f term -F border  --gay)"; sleep 1; done
#Also installed figlet for fun
sudo apt install figlet 
figlet Figlet!
watch -n1 "date '+%D%n%T'|figlet -k"
# Logged this for my Peppermint 9
loginst
toilet -f future 420

#Looking at how top open an UDP server
 grep cwsocket *
 nano yfktest 
 nano subs/logqso.pl 
 nano yfktest 
#I have a nice script to monitor UDP in another terminal 
cat monitorUDPport.txt 
./yfktest ../yfktest-orig-latest/DXpeditionMD.yfk 
git commit -m "tried to restore QSO broadcasting on port 12060"
git push
sudo tcpdump -i lo -n udp port 12060 -X

# ON4ACP 190830

git commit -m "Messed up everything with git. So started over with the 
original version of yfktest and will only add QSO broadcast and Operator change 
with Alt+p."

# Looking at ESC key
nano winkeyer.pl 
nano readakey.pl 
#In keyboardmode.pl it works!!
nano keyboardmode.pl 

./winkeydaemon.pl
# Could not open serial port... Forgot to install PERL module
sudo cpan install Device::SerialPort
./winkeydaemon.pl
#Still not working... No write permission for /dev/tttyUSB0
ls -l /dev/ttyUSB0 
#owner is root, group is dialout
id -Gn
#I am not member of dialout :-(
sudo adduser pcara dialout
./winkeydaemon.pl
#Still not working
id -Gn
#Not member of dialout?? You have to logout and login again for changes to take 
#effect!!

# ON4ACP 190831 commit did not stage my files
# probably because I changed several files and git rather lets you commit only
# files you want to. To commit a singel file, you first have to add it (again).
# to commit everything you can use git commit -a
pcara@latitude /movies/HAM/yfktest/yfktest-dx-pedition $ git commit -m "Now also 
key just under ESC on QWERTY aborts cw."
On branch master
Your branch is up to date with 'origin/master'.

Changes not staged for commit:
	modified:   logbook.txt
	modified:   subs/readakey.pl
	modified:   winkeydaemon.pl
	modified:   yfktest

Untracked files:
	DXPED.yfk
	subs/readakey.pl.phc

no changes added to commit
pcara@latitude /movies/HAM/yfktest/yfktest-dx-pedition $ git commit -am "<your 
message>"

190903 Finally got it working! Managed to log into N1MM+
Everything was fine but the bloody windows firewall (that I switched off 
on the LAN) was doing something nasty. I could see my UDP packets come 
in on WireShark but the were not picked up by N1MM+. Switching off the 
Firewall on the WAN solved the problem. Very strange but I now realize 
that Windows might mean "Windows network" (NetBIOS etc.) instead of LAN.

